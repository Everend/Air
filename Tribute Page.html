<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<title>Tribute Page</title>
		<link rel="stylesheet"type="text/css"href="css/tp.css">
	</head>
	<body>
		<img src="img/pb.jpg">
		<input type="file" onchange="foo();">
		<canvas style="background:gainsboro;"></canvas>
		<script src="https://cdn.jsdelivr.net/npm/exif-js"></script>
		<script>
			function foo(obj){
				var input = document.querySelector('input'),
					img = document.querySelector('img'),
					canvas = document.querySelector('canvas'),
					orientation = 1;
				EXIF.getData(img, function(){
					orientation = EXIF.getTag(this, 'Orientation');
					alert(orientation);
					orientation = 6;
					canvas.width = img.width;
					canvas.height = img.height;
					var context = canvas.getContext('2d');
					context.clearRect(0, 0, img.width, img.height);
					var imageWidth = img.width;
					var imageHeight = img.height;
					if(orientation !== 1){
					switch(orientation){
						case 6://顺时针90°处理
							canvas.width = imageHeight;
							canvas.height = imageWidth;
							context.rotate(Math.PI / 2);
							context.drawImage(img, 0, -imageHeight, imageWidth, imageHeight);
							break;
						case 8://逆时针90°
							canvas.width = imageHeight;
							canvas.height = imageWidth;
							context.rotate(3 * Math.PI / 2);
							context.drawImage(img, -imageWidth, 0, imageWidth, imageHeight);
							break;
						case 3://旋转180°
							context.rotate(Math.PI);
							context.drawImage(img, -imageWidth, -imageHeight, imageWidth, imageHeight);
							break;
						}
					}else{
						context.drawImage(img, 0, 0, imageWidth, imageHeight);
					}
				});
			}
		</script>
	</body>
</html>
